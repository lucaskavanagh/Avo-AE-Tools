app.beginUndoGroup("SetupSharableComp");var completeString = prompt("Please enter the complete script text, use / for a line break and // for a slide break"); // Prompt for the scriptvar compLength = ~~(completeString.length/10); // Calculate total comp length (in seconds)if (compLength<1) {    alert("Script is too short");} else {var newComp = app.project.items.addComp("MainComp", 1080, 1080, 1.0, compLength, 30); // Create a comp proportional to the total script lengthvar whiteBG = newComp.layers.addSolid([1,1,1], "White Background", newComp.width, newComp.height,1);}var splitSlides = completeString.split("//"); // Split the entire script into slidesvar slideStart = 0;var slideEnd = compLength;for (ii=0; ii<splitSlides.length; ii++) { // Loop over slides    var splitLines = splitSlides[ii].split("/")// Split the slide string into number of lines    slideEnd = slideStart + splitSlides[ii].length/10;            // Create the citation        var citeFontSize = 30;        var citationString = "Source: Footage:";        var citeLayer = newComp.layers.addBoxText([(citeFontSize+20)*citationString.length,(citeFontSize+20)],citationString);        citeLayer.inPoint = slideStart;        citeLayer.outPoint = slideEnd;        var citeOpacity = citeLayer.property("ADBE Transform Group").property("ADBE Opacity");        citeOpacity.setValue(40);        var citeLayer_TextProp = citeLayer.property("ADBE Text Properties").property("ADBE Text Document");        var citeLayer_TextDocument = citeLayer_TextProp.value;        citeLayer_TextDocument.resetCharStyle();        citeLayer_TextDocument.fillColor = [1, 1, 1];        citeLayer_TextDocument.strokeWidth = 0;        citeLayer_TextDocument.tracking = 25;        citeLayer_TextDocument.font = "Proxima Nova";        citeLayer_TextDocument.justification = ParagraphJustification.LEFT_JUSTIFY;         citeLayer_TextDocument.fontSize = citeFontSize;        citeLayer_TextDocument.applyFill =true;        citeLayer_TextDocument.applyStroke = false;        citeLayer_TextProp.setValue(citeLayer_TextDocument);        citeLayer.boxText = true;                // Position citation layer        var citeRectText = citeLayer.sourceRectAtTime(0, false);        var citeBoxSizeX = citeLayer_TextDocument.boxTextSize[0];        var citeBoxSizeY = citeLayer_TextDocument.boxTextSize[1];         citeLayer.anchorPoint.setValue([citeRectText.left, (citeRectText.top+citeBoxSizeY/4)]);        citeLayer.position.setValue([25,1055,0]);        for (jj=0; jj<splitLines.length; jj++) { // Loop over lines in current slide                // Create and format text layer        var fontSize = 60;        var textLayer = newComp.layers.addBoxText([(fontSize+20)*splitLines[jj].length,(fontSize+20)],splitLines[jj]);        textLayer.inPoint = slideStart+0.5*jj;        textLayer.outPoint = slideEnd;        var textLayer_TextProp = textLayer.property("ADBE Text Properties").property("ADBE Text Document");        var textLayer_TextDocument = textLayer_TextProp.value;        textLayer_TextDocument.resetCharStyle();        textLayer_TextDocument.fillColor = [1, 1, 1];        textLayer_TextDocument.strokeWidth = 0;        textLayer_TextDocument.font = "Proxima Nova";        textLayer_TextDocument.justification = ParagraphJustification.LEFT_JUSTIFY;         textLayer_TextDocument.fontSize = fontSize;        textLayer_TextDocument.applyFill =true;        textLayer_TextDocument.applyStroke = false;        textLayer_TextProp.setValue(textLayer_TextDocument);        textLayer.boxText = true;                // Position text layer        var sourceRectText = textLayer.sourceRectAtTime(0, false);        var textBoxSizeX = textLayer_TextDocument.boxTextSize[0];        var textBoxSizeY = textLayer_TextDocument.boxTextSize[1];         textLayer.anchorPoint.setValue([sourceRectText.left, (sourceRectText.top+textBoxSizeY/4)]);        textLayer.position.setValue([50,100*(jj+1),0]);                // Create background shape layer         var shapeX = sourceRectText.width+70;        var shapeY = fontSize+15;                var bgLayer = newComp.layers.addShape();        bgLayer.inPoint = slideStart+0.5*jj;        bgLayer.outPoint = slideEnd;        var newShape = bgLayer.property("ADBE Root Vectors Group");                var shapeTransform = bgLayer.property("ADBE Transform Group");        var shapeAnchor = shapeTransform.property("ADBE Anchor Point");        shapeAnchor.setValue([-shapeX/2,0]);        var shapePosition = shapeTransform.property("ADBE Position");        shapePosition.setValue([0,(100*(jj+1))]);                var newRect = newShape.addProperty("ADBE Vector Shape - Rect");        var shapeFill = newShape.addProperty("ADBE Vector Graphic - Fill");               var shapeColor = shapeFill.property("ADBE Vector Fill Color");       shapeColor.setValue([0,0,0]);       var shapeOpacity = shapeFill.property("ADBE Vector Fill Opacity");       shapeOpacity.setValue(40);        shapeRect = newShape.property("ADBE Vector Shape - Rect"); // adding fill invalidates shapeRect        var rectSize = shapeRect.property("ADBE Vector Rect Size");        var rectPosition = shapeRect.property("ADBE Vector Rect Position");        rectSize.setValue([shapeX, shapeY]);                //Order layers correctly        textLayer.moveBefore(bgLayer);        }        slideStart = slideEnd;        }app.endUndoGroup();